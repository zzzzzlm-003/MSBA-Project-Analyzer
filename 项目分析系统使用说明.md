# 项目分析系统使用说明

## 功能概述

这个系统可以帮助你：
1. 从Google Drive批量下载项目PDF文档
2. 使用AI自动提取关键信息（行业、应用场景、公司用心程度、预期成果等）
3. 导出为Excel文件，方便筛选和比较

## 安装步骤

### 1. 安装Python依赖

```bash
pip install -r requirements.txt
```

### 2. 配置OpenAI API密钥

创建 `.env` 文件（在项目根目录）：

```env
OPENAI_API_KEY=your_openai_api_key_here
```

或者直接在环境变量中设置：
```bash
# Windows PowerShell
$env:OPENAI_API_KEY="your_api_key"

# Windows CMD
set OPENAI_API_KEY=your_api_key

# Linux/Mac
export OPENAI_API_KEY=your_api_key
```

### 3. 准备Google Drive链接

有两种方式：

**方式1：在配置文件中设置**
编辑 `project_analyzer_config.json`，将Google Drive链接添加到 `google_drive_links` 数组中。

**方式2：运行时输入**
运行程序时，选择模式1，然后逐个输入链接。

## 使用方法

### 基本使用

```bash
python project_analyzer.py
```

程序会提示你选择：
1. 从Google Drive链接列表下载并分析
2. 分析本地已有的PDF文件（需要先将PDF放在 `data/projects/` 目录）

### 批量处理流程

1. **下载PDF文件**
   - 程序会自动从Google Drive下载所有PDF
   - 文件保存在 `data/projects/` 目录
   - 文件命名格式：`project_001.pdf`, `project_002.pdf` 等

2. **AI信息提取**
   - 自动解析每个PDF的文本内容
   - 使用OpenAI API提取结构化信息
   - 提取的关键属性：
     - 项目名称
     - 所处行业
     - 应用场景
     - 公司用心程度（1-10分，带说明）
     - 预期成果
     - 项目编号
     - 公司名称
     - 技能要求
     - 项目描述摘要

3. **导出结果**
   - Excel文件保存在 `data/output/` 目录
   - 文件名格式：`项目分析_YYYYMMDD_HHMMSS.xlsx`
   - Excel包含格式化的表格，方便筛选和排序

## 输出文件说明

### Excel文件结构

| 列名 | 说明 |
|------|------|
| 项目编号 | 项目ID或编号 |
| 项目名称 | 项目标题 |
| 公司名称 | 合作公司 |
| 所处行业 | 行业分类 |
| 应用场景 | 详细应用场景描述 |
| 公司用心程度 | 1-10分评分及理由 |
| 预期成果 | 项目交付物 |
| 技能要求 | 所需技能 |
| 项目描述摘要 | 简要描述 |
| 源文件 | PDF文件名 |

### JSON文件（可选）

如果选择导出JSON格式，会生成结构化的JSON文件，方便后续处理。

## 高级功能

### 自定义提取属性

编辑 `project_analyzer.py` 中的 `AIInfoExtractor.extract_project_info` 方法，修改prompt来提取其他属性。

### 调整AI模型

在 `project_analyzer_config.json` 中修改 `openai_model`：
- `gpt-4o-mini` - 快速且经济（推荐）
- `gpt-4` - 更准确但更慢更贵
- `gpt-3.5-turbo` - 经济选择

### 批量处理大量文件

如果PDF文件很多，建议：
1. 分批处理（每次20-30个）
2. 使用 `gpt-4o-mini` 模型降低成本
3. 检查API使用量，避免超出限制

## 故障排除

### 问题1：无法下载Google Drive文件

**解决方案：**
- 确保链接是公开共享的
- 检查网络连接
- 如果文件很大，可能需要手动下载

### 问题2：PDF解析失败

**解决方案：**
- 确保PDF文件没有加密
- 尝试使用不同的PDF库（PyPDF2或pdfplumber）
- 检查PDF文件是否损坏

### 问题3：AI提取失败

**解决方案：**
- 检查OpenAI API密钥是否正确
- 检查API余额是否充足
- 查看错误信息，可能是PDF文本提取不完整

### 问题4：Excel导出失败

**解决方案：**
- 确保 `data/output/` 目录存在
- 检查是否有写入权限
- 确保openpyxl库已正确安装

## 成本估算

使用 `gpt-4o-mini` 模型：
- 每个PDF约消耗 1000-2000 tokens
- 76个PDF约消耗 76,000-152,000 tokens
- 成本约：$0.15 - $0.30（取决于PDF长度）

## 下一步：Notion集成

如果需要将结果导入Notion，可以使用Notion API。可以创建 `notion_integration.py` 来实现此功能。

## 注意事项

1. **API密钥安全**：不要将 `.env` 文件提交到Git
2. **PDF文件大小**：大文件可能需要更长时间处理
3. **API限制**：注意OpenAI API的速率限制
4. **数据备份**：建议定期备份提取的数据

## 联系与支持

如有问题，请检查：
1. Python版本（建议3.8+）
2. 所有依赖包是否正确安装
3. API密钥是否有效
4. 网络连接是否正常

